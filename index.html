<!DOCTYPE html>
<html>
<head>
  <title>Split Bill - Tariska & Friends</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    input, select, button { margin: 5px; padding: 5px; }
    table, th, td { border: 1px solid #ccc; border-collapse: collapse; padding: 5px; }
    th { background-color: #f0f0f0; }
  </style>
</head>
<body>
  <h2>ðŸ’¸ Split Bill - Tariska & Friends</h2>

  <label>Description: <input id="desc" /></label>
  <label>Paid By:
    <select id="paidBy">
      <option>Tariska</option>
      <option>Delano</option>
      <option>Lika</option>
      <option>Husin</option>
    </select>
  </label><br>

  <h3>Who Shared and How Much?</h3>
  <table>
    <tr><th>Name</th><th>Amount (Rp)</th></tr>
    <tr><td>Tariska</td><td><input type="number" id="Tariska" value="0"></td></tr>
    <tr><td>Delano</td><td><input type="number" id="Delano" value="0"></td></tr>
    <tr><td>Lika</td><td><input type="number" id="Lika" value="0"></td></tr>
    <tr><td>Husin</td><td><input type="number" id="Husin" value="0"></td></tr>
  </table><br>

  <button onclick="addExpense()">Add Expense</button>

  <h3>ðŸ§¾ Expenses</h3>
  <table id="expenseTable">
    <tr><th>Description</th><th>Paid By</th><th>Details</th></tr>
  </table>

  <h3>ðŸ“Š Who Owes Whom</h3>
  <pre id="result"></pre>

  <script>
    const names = ["Tariska", "Delano", "Lika", "Husin"];
    const balances = {}; // Net balance
    const ledger = {};   // Who owes whom

    names.forEach(name => {
      balances[name] = 0;
      ledger[name] = {};
      names.forEach(n2 => {
        if (name !== n2) ledger[name][n2] = 0;
      });
    });

    const expenses = [];

    function addExpense() {
      const desc = document.getElementById("desc").value;
      const paidBy = document.getElementById("paidBy").value;

      let total = 0;
      const shares = {};

      names.forEach(name => {
        const val = parseFloat(document.getElementById(name).value) || 0;
        shares[name] = val;
        total += val;
      });

      if (!desc || total === 0) {
        alert("Please enter a description and non-zero shared amounts.");
        return;
      }

      expenses.push({ desc, paidBy, shares });

      // Update balances and ledger
      names.forEach(name => {
        const share = shares[name];
        if (name !== paidBy && share > 0) {
          balances[name] -= share;
          balances[paidBy] += share;
          ledger[name][paidBy] += share;
        }
      });

      updateTable();
      updateResult();
      clearInputs();
    }

    function updateTable() {
      const table = document.getElementById("expenseTable");
      table.innerHTML = `<tr><th>Description</th><th>Paid By</th><th>Details</th></tr>`;
      expenses.forEach(e => {
        const details = Object.entries(e.shares)
          .filter(([n, amt]) => amt > 0)
          .map(([n, amt]) => `${n}: Rp ${amt.toLocaleString('id-ID')}`)
          .join('<br>');
        table.innerHTML += `<tr><td>${e.desc}</td><td>${e.paidBy}</td><td>${details}</td></tr>`;
      });
    }

    function updateResult() {
      let output = "";

      names.forEach(person => {
        for (let other of names) {
          if (person !== other && ledger[person][other] > 0) {
            output += `${person} owes ${other}: Rp ${ledger[person][other].toLocaleString('id-ID')}\n`;
          }
        }
      });

      document.getElementById("result").textContent = output || "ðŸŽ‰ All settled!";
    }

    function clearInputs() {
      document.getElementById("desc").value = "";
      names.forEach(name => document.getElementById(name).value = "0");
    }
  </script>
</body>
</html>
